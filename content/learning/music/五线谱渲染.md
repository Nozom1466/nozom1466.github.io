---
title: '五线谱渲染'
date: 2025-12-13T23:54:35-05:00
slug:
summary: abc.js 网页渲染五线谱 
description:
cover:
    image:
    alt:
    caption:
    relative: false
showtoc: false
draft: false
tags: ['music', 'test']
categories:
---

## 实现方法

使用 [abcjs](https://www.abcjs.net/) 库渲染 ABC 记谱法为五线谱，并支持音频播放。

### 创建 Hugo Shortcode
 
在 `layouts/shortcodes/abc.html` 中创建 shortcode：

```html
<div id="abc-paper"></div>
<div id="abc-audio"></div>
<script src="https://cdn.jsdelivr.net/npm/abcjs@6.4.1/dist/abcjs-basic-min.js"></script>
<script>
  var visualObj = ABCJS.renderAbc('abc-paper', abcNotation, {
    responsive: 'resize'
  });
  // 播放功能
  var synthControl = new ABCJS.synth.SynthController();
  synthControl.load('#abc-audio', null, {
    displayPlay: true,
    displayProgress: true,
    displayWarp: true
  });
  synthControl.setTune(visualObj[0], false);
</script>
```

最后修改 css 样式。

### 使用方法

在 Markdown 中使用 shortcode，`play="true"` 启用播放控件：

```markdown
{{</* abc play="true" */>}}
X:1
T:小星星
M:4/4
L:1/4
K:C
C C G G | A A G2 |
{{</* /abc */>}}
```

## 播放测试

{{< abc play="true" >}}
X:1
T:小星星 (可播放)
M:4/4
L:1/4
Q:1/4=100
K:C
C C G G | A A G2 | F F E E | D D C2 |
G G F F | E E D2 | G G F F | E E D2 |
C C G G | A A G2 | F F E E | D D C2 |
{{< /abc >}}

## 仅高音谱号（Treble Clef）

{{< abc play="true" >}}
X:1
T:高音谱号示例 - 小星星
M:4/4
L:1/4
K:C clef=treble
C C G G | A A G2 | F F E E | D D C2 |
{{< /abc >}}

## 仅低音谱号（Bass Clef）

{{< abc play="true" >}}
X:2
T:低音谱号示例
M:4/4
L:1/4
K:C clef=bass 
C, D, E, F, | G, A, B, C | D E F G | A B c2 |
{{< /abc >}}

## 高音+低音谱号（大谱表）

{{< abc play="true" >}}
X:3
T:大谱表示例
M:4/4
L:1/4
K:C
%%staves {RH LH}
V:RH clef=treble
V:LH clef=bass
[V:RH] c e g c' | b g e c |
[V:LH] C, E, G, C | G, E, C, G,, |
{{< /abc >}}

## 常用音符与乐谱标记

{{< abc play="true" >}}
X:4
T:基础标记示例
C:作曲者
M:4/4
L:1/8
Q:1/4=120
K:G
|: "G"G2 AB c2 BA | "D"G2 AB "Em"c2 d2 |
"C"e2 dc B2 AG | "D7"F2 EF "G"G4 :|
{{< /abc >}}

## 附点与时值

{{< abc play="true" >}}
X:5
T:附点音符
M:4/4
L:1/8
K:C
C4 C3 C | C2 C3/2 C/ C C | C6 C2 | C7 C |
w: 二分 附点四分 四分 附点八分 十六分 八分 八分 附点二分 四分 附点全音符 八分
{{< /abc >}}

## 休止符

{{< abc play="true" >}}
X:6
T:休止符示例
M:4/4
L:1/8
K:C
C2 z2 C2 z2 | C z C z C2 z2 | z4 C4 | z8 |
w: 四分休止 四分休止 八分休止 八分休止 二分休止 二分音符 全休止
{{< /abc >}}

## 延音线与连音线

{{< abc play="true" >}}
X:7
T:延音线与连音线
M:4/4
L:1/4
K:C
C-C E-E | G2-G2 | (CDE) (GAB) | (C2 E2) |
w: 延音线 延音线 连音线 连音线
{{< /abc >}}

## 三连音与多连音

{{< abc play="true" >}}
X:8
T:三连音示例
M:4/4
L:1/8
K:C
(3CDE (3FGA | (3:3:3GGG (3:3:3AAA | (4CDEF G4 | (6CDEFGA B2 |
w: 三连音 三连音 三连音 三连音 四连音 四分音符 六连音
{{< /abc >}}

## 常见调式
{{< abc play="true" >}}
X:9
T:C大调
M:4/4
L:1/4
K:C
C D E F | G A B c |
{{< /abc >}}

{{< abc play="true" >}}
X:10
T:G大调 (一个升号)
M:4/4
L:1/4
K:G
G A B c | d e f g |
{{< /abc >}}

{{< abc play="true" >}}
X:11
T:F大调 (一个降号)
M:4/4
L:1/4
K:F
F G A _B | c d e f |
{{< /abc >}}

{{< abc play="true" >}}
X:12
T:A小调
M:4/4
L:1/4
K:Am
A B c d | e f g a |
{{< /abc >}}

## 力度记号

{{< abc play="true" >}}
X:13
T:力度记号
M:4/4
L:1/4
K:C
!pp!C D !p!E F | !mp!G A !mf!B c | !f!d e !ff!f g | !sfz!a2 !fp!b2 |
{{< /abc >}}

## 速度记号

{{< abc play="true" >}}
X:14
T:不同速度
M:4/4
L:1/4
Q:1/4=60
K:C
"Largo"C D E F |
{{< /abc >}}

{{< abc play="true" >}}
X:15
M:4/4
L:1/4
Q:1/4=120
K:C
"Allegro"C D E F |
{{< /abc >}}

{{< abc play="true" >}}
X:16
M:4/4
L:1/4
Q:1/4=180
K:C
"Presto"C D E F |
{{< /abc >}}

## 反复记号

{{< abc play="true" >}}
X:17
T:反复记号
M:4/4
L:1/4
K:C
|: C D E F | G A B c :|
|: c B A G |1 F E D C :|2 F E D C ||
{{< /abc >}}

## 演奏记号

{{< abc play="true" >}}
X:18
T:演奏记号
M:4/4
L:1/4
K:C
!accent!C !emphasis!D !fermata!E !tenuto!F | !staccato!G !wedge!A !upbow!B !downbow!c |
!trill!d !mordent!e !turn!f !slide!g |
{{< /abc >}}

## 装饰音

{{< abc play="true" >}}
X:19
T:装饰音
M:4/4
L:1/4
K:C
{D}C {ED}E {DED}G A | {/D}C {//E}D {///G}E F |
{{< /abc >}}

## 八度记号

{{< abc play="true" >}}
X:20
T:八度标记
M:4/4
L:1/4
K:C
C,, D,, E,, F,, | C, D, E, F, | C D E F | c d e f | c' d' e' f' |
w: 低两个八度 低一个八度 中央八度 高一个八度 高两个八度
{{< /abc >}}

## ABC 记谱法速查

### 基础语法

| 语法 | 说明 | 示例 |
|------|------|------|
| `X:` | 曲目编号 | `X:1` |
| `T:` | 标题 | `T:小星星` |
| `M:` | 拍号 | `M:4/4`, `M:3/4`, `M:6/8` |
| `L:` | 默认时值 | `L:1/4` (四分音符) |
| `K:` | 调号 | `K:C`, `K:G`, `K:Am`, `K:F` |
| `Q:` | 速度 | `Q:1/4=120` |
| `C:` | 作曲者 | `C:Mozart` |

### 音符与八度

| 语法 | 说明 |
|------|------|
| `C D E F G A B` | 低音区音符 |
| `c d e f g a b` | 高音区音符 |
| `C,, D,,` | 低两个八度 |
| `C, D,` | 低一个八度 |
| `c' d'` | 高一个八度 |
| `c'' d''` | 高两个八度 |

### 时值与附点

| 语法 | 说明 |
|------|------|
| `C2` | 两倍时值 |
| `C4` | 四倍时值 |
| `C/2` 或 `C/` | 一半时值 |
| `C/4` | 四分之一时值 |
| `C3/2` | 附点（1.5倍） |
| `C7/4` | 双附点 |

### 休止符

| 语法 | 说明 |
|------|------|
| `z` | 休止符（时值同 L:） |
| `z2` | 二分休止符 |
| `z4` | 全休止符 |
| `z/2` | 八分休止符 |

### 临时升降号

| 语法 | 说明 |
|------|------|
| `^C` | 升 C (C#) |
| `^^C` | 重升 C (Cx) |
| `_C` | 降 C (Cb) |
| `__C` | 重降 C (Cbb) |
| `=C` | 还原 C |

### 连音与延音

| 语法 | 说明 |
|------|------|
| `C-C` | 延音线 |
| `(CDE)` | 连音线（圆滑线） |
| `(3CDE` | 三连音 |
| `(4CDEF` | 四连音 |
| `(6CDEFGA` | 六连音 |

### 小节线与反复

| 语法 | 说明 |
|------|------|
| `\|` | 小节线 |
| `\|]` | 结束双线 |
| `\|:` | 反复开始 |
| `:\|` | 反复结束 |
| `\|1` | 第一结尾 |
| `\|2` | 第二结尾 |
| `::` | 前后反复 |

### 力度记号

| 语法 | 说明 |
|------|------|
| `!pp!` | 很弱 |
| `!p!` | 弱 |
| `!mp!` | 中弱 |
| `!mf!` | 中强 |
| `!f!` | 强 |
| `!ff!` | 很强 |
| `!sfz!` | 突强 |
| `!fp!` | 强后弱 |

### 演奏记号

| 语法 | 说明 |
|------|------|
| `!staccato!` | 断奏（顿音） |
| `!accent!` | 重音 |
| `!tenuto!` | 保持音 |
| `!fermata!` | 延长记号 |
| `!trill!` | 颤音 |
| `!mordent!` | 波音 |
| `!turn!` | 回音 |
| `!upbow!` | 上弓 |
| `!downbow!` | 下弓 |

### 装饰音

| 语法 | 说明 |
|------|------|
| `{g}C` | 前倚音 |
| `{ag}C` | 多个倚音 |
| `{/g}C` | 短倚音（一条斜线） |
| `{//g}C` | 短倚音（两条斜线） |

### 和弦与歌词

| 语法 | 说明 |
|------|------|
| `"Am"C` | 和弦标记 |
| `[CEG]` | 和弦音符 |
| `w:` | 歌词行 |


## Reference
[1] https://docs.abcjs.net/